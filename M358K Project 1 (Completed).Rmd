---
title: "M358K Project 1"
author: "Team: Yang Wang, Wenjing Yang, Youhyun Kang, Lavanya Makdani"
date: "9/14/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## 1.1
5/6 * 5/6 * 5/6 = 125/216  
5/6 * 1/6 * 5/6 * 3 = 75/216  
1/6 * 1/6 * 5/6 * 3 = 15/216  
1/6 * 1/6 * 1/6 = 1/216

P(win) = 1 - P(lose) = 1 - (125/216) = 91/216


## 1.2
The House.
```{r}
x = -1*(125/216) + 1*(75/216) + 2*(15/216) + 3*1/216
print (x)
```


## 1.3
-1(125/216) + (75/216) + a(15/216) + b(1/216) = 0  
-125 + 75 + 15a + b = 0  
-50 + 15a + b = 0  
15a + b = 50  
b = -15a + 50  
In this given situation, we would want b > a, so a < b.  
Then,   
a < -15a + 50  
16a < 50
a < 50/16 = 3.125
b > -15 (50/16) + 50
b > 25/8 = 3.125

Example:  
a = 3  
b = 5  
-1(125/216) + (75/216) + a(15/216) + b(1/216) = 0  
-1(125/216) + (75/216) + 3(15/216) + 5(1/216) = 0  


## 1.4
```{r}
game = rbinom(100,3,1/6)
loss = as.integer(game == 0)
win = game -loss
mean(win)
```


## 1.5
According to the Strong Law of Large Numbers, the probability of the sample average reaching the expected value is 1, which means that "the average of the results obtained from a large number of trials should be close to the expected value and will tend to become closer to the expected value as more trials are performed." (Quoted from Wikipedia definition of Law of Large Numbers)  
  
Answers to 1.2 and 1.4 are great examples of the Strong Law of Large Numbers because we see that the average of the results we get from 1.4 gets closer and closer to the expected value we calculated in 1.2, -0.0787037, as more trials are executed. 


## 1.6
```{r}
game = rbinom(100,3,1/6)
win = 2
wealth = rep(2)

for (i in game){
  if (i == 0){
    win = win-1
    
  }else if (i == 1){
    win = win+1
    
  }else if (i == 2){
    win = win+2
    
  }else if (i == 3){
    win = win+3
    
  }
  wealth = append(wealth, win)
  if (win >= 4 || win <= 0){
    
    break
  }
  
}

t = 0 : (length(wealth)-1)

print(game)
print(win)
print(t)
plot(t, wealth, xlab='Rounds')

lines(t, wealth, col='Blue')
```


## 1.7
```{r}
#a is the count for running the simulation 100 times
a = 0
win.times = c()
loss.times = c()

while (a < 100) { a= a+1

#win stands for wealth
win = 2
round.number = 0
while (win == 1 || win == 2 || win == 3){
  game = rbinom(1,3,1/6)
  toll = as.integer(game)
  round.number = round.number + 1
  if (game == 0){
    win = win-1
  }else if (game == 1){
    win = win+1
  }else if (game == 2){
    win = win+2
  }else if (game == 3){
    win = win+3
  }
  if (win >= 4){
    win.times = append(win.times, round.number)}
    if (win <= 0){
    loss.times = append(loss.times, round.number)} 

}}

#Number of rounds played for all players
alltimes = append(win.times, loss.times)

#Average number of rounds the 100 gamblers played
print(mean(alltimes))

#proportion of gamblers who went bankrupt
print(length(loss.times)/100)

#proportion of gamblers who finished with at least $4 in their pocket
print(length(win.times)/100)

#histogram of the number of rounds played for the players who went bankrupt only
hist(loss.times, main = "Bankrupt", xlab = "Gamblers", ylab = "Number of Rounds Played", border = "Black", col = "Brown")

#histogram of the number of rounds played for the remaining players
hist(win.times, main = "Rich", xlab = "Gamblers", ylab = "Number of Rounds Played", border = "Black", col = "Gold")

#histogram of the number of rounds played for all players
hist(alltimes, main = "All Players", xlab = "Gamblers", ylab = "Number of Rounds Played", border = "Black", col = "Light Blue")
```

